
focus_tree = {
	id = republican_focus
	
	country = {
		factor = 0
		
		modifier = {
			add = 10
			tag = SPN
			has_dlc = "La Resistance"
		}
	}

	default = no

	continuous_focus_position = { x = 150 y = 1000 }

	focus = {
		id = SPR_the_popular_front

		
		icon = GFX_goal_generic_demand_territory
		x = 10
		y = 4
	
		cost = 5

		available_if_capitulated = yes
		bypass = {
			has_global_flag = spanish_civil_war
		}

		completion_reward = {
			custom_effect_tooltip = spawn_republicans_tt2
			if = {
				limit = {
					NOT = {
						has_global_flag = spanish_civil_war
					}
				}
				set_country_flag = SPR_did_reinforcments
			}
			
			
			
		}
	}
	focus = {
		id = SPR_secure_the_guardia_de_asalto
		available = {
		}
		bypass = {
			has_global_flag = spanish_civil_war
		}
		prerequisite = { focus = SPR_the_popular_front }
		mutually_exclusive = { focus = SPR_secure_the_guardia_civil }
		
		icon = GFX_goal_generic_political_pressure
		x = -1
		y = 1
		
		relative_position_id = SPR_the_popular_front
		cost = 7.2

		available_if_capitulated = yes
		search_filters = { FOCUS_FILTER_SPA_CIVIL_WAR }
		completion_reward = {
			army_experience = 10
			custom_effect_tooltip = SPR_secure_the_guardia_de_asalto_tt
			SPR = {
				add_to_variable = { var = spa_civil_war_divisions_counter_var value = -14 }
				add_to_variable = { var = spr_civil_war_divisions_counter_var value = 8 }
			}
		
			SPR = {
				set_country_flag = SPR_secure_the_guardia_de_asalto_flag
			}
			SPN = {
				set_country_flag = SPR_secure_the_guardia_de_asalto_flag
			}
			custom_effect_tooltip = SPR_secure_the_guardia_get_both_types_tt
			custom_effect_tooltip = SPR_remove_after_civil_war_tt
		}
	}

	focus = {
		id = SPR_secure_the_guardia_civil
		available = {
		}
		bypass = {
		}
		prerequisite = { focus = SPR_the_popular_front }
		mutually_exclusive = { focus = SPR_secure_the_guardia_de_asalto }
		
		icon = GFX_focus_generic_support_the_left_right
		x = 1
		y = 1
	
		relative_position_id = SPR_the_popular_front
		cost = 7.2

		available_if_capitulated = yes
		search_filters = { FOCUS_FILTER_STABILITY FOCUS_FILTER_SPA_CIVIL_WAR }
		completion_reward = {
			add_stability = 0.05
		
			custom_effect_tooltip = SPR_secure_the_guardia_civil_tt_2
			SPR = {
				add_to_variable = { var = spa_civil_war_divisions_counter_var value = -8 }
				add_to_variable = { var = spr_civil_war_divisions_counter_var value = 14 }
			}
			
			
			SPR = {
				set_country_flag = SPR_secure_the_guardia_civil_flag
			}
			SPN = {
				set_country_flag = SPR_secure_the_guardia_civil_flag
			}
			custom_effect_tooltip = SPR_secure_the_guardia_get_both_types_tt
			#custom_effect_tooltip = SPR_remove_after_civil_war_tt
		}
	}
	focus = {
		id = SPR_enlarge_the_weapon_caches
		available = {
		}
		bypass = {
			has_global_flag = spanish_civil_war
		}
		
		prerequisite = { focus = SPR_secure_the_guardia_de_asalto focus = SPR_secure_the_guardia_civil }
		
		icon = GFX_goal_generic_military_sphere
		x = 1
		y = 1
		
		relative_position_id = SPR_secure_the_guardia_de_asalto
		cost = 7.2

		available_if_capitulated = yes
		search_filters = { FOCUS_FILTER_SPA_CIVIL_WAR }
		completion_reward = {
			army_experience = 5
			custom_effect_tooltip = spawn_republicans_tt
			if = {
				limit = {
					NOT = {
						has_global_flag = spanish_civil_war
					}
				}
				set_country_flag = SPR_did_reinforcments2
			}
			
		}
	}

	focus = {
		id = SPR_train_the_union_youth
		available = {
		}
		bypass = {
			has_global_flag = spanish_civil_war
		}
		prerequisite = { focus = SPR_enlarge_the_weapon_caches }
		
		icon = GFX_goal_generic_more_territorial_claims
		x = 0
		y = 1
		relative_position_id = SPR_enlarge_the_weapon_caches
		cost = 7.2

		available_if_capitulated = yes
		search_filters = { FOCUS_FILTER_POLITICAL FOCUS_FILTER_SPA_CIVIL_WAR }
		completion_reward = {
			add_popularity = {
				ideology = communism
				popularity = 0.05
			}
			SPR = {
				set_country_flag = SPR_train_the_union_youth_flag
			}
			SPN = {
				set_country_flag = SPR_train_the_union_youth_flag
			}
			SPR = {
				add_to_variable = { var = spr_civil_war_divisions_counter_var value = 7 }
			}
			custom_effect_tooltip = SPR_train_the_union_youth_tt
			custom_effect_tooltip = SPR_remove_after_civil_war_tt
		}
	}

	

	focus = {
		id = SPR_distribute_arms_to_the_people
		available = {
		}
		bypass = {
			has_global_flag = spanish_civil_war
		}
		prerequisite = { focus = SPR_train_the_union_youth }
		
		icon = GFX_goal_generic_small_arms
		x = 0
		y = 1
		relative_position_id = SPR_train_the_union_youth
		cost = 7.2

		available_if_capitulated = yes
		search_filters = { FOCUS_FILTER_POLITICAL FOCUS_FILTER_SPA_CIVIL_WAR }
		completion_reward = {
			add_popularity = {
				ideology = neutrality
				popularity = 0.05
			}
			SPR = {
				add_to_variable = { var = spr_civil_war_divisions_counter_var value = 8 }
			}
			custom_effect_tooltip = SPR_distribute_arms_to_the_people_tt
			custom_effect_tooltip = SPR_remove_after_civil_war_tt
			SPR = {
				set_country_flag = SPR_distribute_arms_to_the_people_flag
			}
			SPN = {
				set_country_flag = SPR_distribute_arms_to_the_people_flag
			}
				
		}
	}

	focus = {
		id = SPR_disband_the_army
		available = {
		}
		bypass = {
			has_global_flag = spanish_civil_war
		}
		prerequisite = { focus = SPR_distribute_arms_to_the_people }
		
		icon = GFX_goal_generic_forceful_treaty
		x = 0
		y = 1
		relative_position_id = SPR_distribute_arms_to_the_people
		cost = 7.2

		available_if_capitulated = yes
		search_filters = { FOCUS_FILTER_POLITICAL FOCUS_FILTER_SPA_CIVIL_WAR }
		completion_reward = {
			SPR = {
				set_country_flag = SPR_disband_the_army_flag
			}
			custom_effect_tooltip = SPR_disband_the_army_tt
			SPR = {
				country_event = lar_spain.2 
			}
			SPR = {
				add_to_variable = { var = spa_civil_war_divisions_counter_var value = -2 }
			}
			custom_effect_tooltip = SPA_rep_army_modif
				add_to_variable = {
					SPA_rep_army_attack_factor_var = -0.015
					tooltip = army_attack_factor_tooltip
				}
				add_to_variable = {
					SPA_rep_defence_factor_var = -0.015
					tooltip = army_defense_factor_tooltip
				}
			SPR = {
				add_to_variable = {
					SPR_army_attack_factor_var = -0.03
					tooltip = army_attack_factor_tooltip
				}
				add_to_variable = {
					SPR_army_defence_factor_var = -0.03
					tooltip = army_defense_factor_tooltip
				}
			}
		}
	}


	#Republican and Soviet Army Treee

	focus = { 
		id = SPR_army_tree_choise
		icon = GFX_SOV_return_of_the_rocor_ccp_2d_sov_compatibility

		x = 10
		y = 0

		cost = 1

		ai_will_do = {
			factor = 1
		}

		available = {
			has_global_flag = spanish_civil_war
		}

		bypass = {}

		cancel_if_invalid = yes
		continue_if_invalid = no
		available_if_capitulated = no

		completion_reward = {
			custom_effect_tooltip = SPA_rep_army_modif
			add_to_variable = {
				SPA_rep_recruitable_population_factor_var = 0.15
				tooltip = CAN_recruitable_tt1
			}
			add_to_variable = {
				SPA_rep_army_defence_factor_var = -0.03
				tooltip = army_defense_factor_tooltip
			}
		}
	}

	focus = { 
		id = SPR_soviet_small_giver
		icon = GFX_focus_spr_international_brigades

		relative_position_id = SPR_army_tree_choise
		x = -5
		y = 1

		cost = 5

		prerequisite = {
			focus = SPR_army_tree_choise
		}

		mutually_exclusive = {
			focus = SPR_republic_army
		}

		ai_will_do = {
			factor = 1
		}

		available = {
			has_global_flag = spanish_civil_war
		}

		bypass = {}

		cancel_if_invalid = yes
		continue_if_invalid = no
		available_if_capitulated = no

		completion_reward = {
			custom_effect_tooltip = SPR_eco_modif
			add_to_variable = {
				var = SPA_rep_industry_industrial_capacity_factory
				value = -0.025
				tooltip = industrial_capacity_factory_tooltip
			}
			custom_effect_tooltip = MANspace
			custom_effect_tooltip = SPA_rep_army_modif
			add_to_variable = {
				SPA_rep_army_org_factor_var = 0.03
				tooltip = army_attack_factor_tooltip
			}
			add_to_variable = {
				SPA_rep_army_org_factor_var = -0.05
				tooltip = army_org_factor_tooltip
			}
			add_to_variable = {
				SPA_rep_max_planning_var = -0.25
				tooltip = max_planning_tooltip
			}
			add_doctrine_cost_reduction = {
				name = land_doc_bonus
				cost_reduction = 0.4
				uses = 1
				category = land_doctrine
			}
			hidden_effect = {
				division_template = { #SOVIET INF
					name = "Legión Internacional" 
					division_names_group = SOV_INF_01
					template_counter = 173
					is_locked = yes
					force_allow_recruiting = yes
					
					regiments = {
						mountaineers = { x = 0 y = 0 }
						mountaineers = { x = 0 y = 1 }
						mountaineers = { x = 0 y = 2 }

						mountaineers = { x = 1 y = 0 }
						mountaineers = { x = 1 y = 1 }
						volkssturm_infantry = { x = 1 y = 2 }
										
						volkssturm_infantry = { x = 2 y = 0 }
						volkssturm_infantry = { x = 2 y = 1 }
						volkssturm_infantry = { x = 2 y = 2 }
										
						artillery_brigade = { x = 3 y = 0 }
						artillery_brigade = { x = 3 y = 1 }	
						artillery_brigade = { x = 3 y = 2 }
						artillery_brigade = { x = 3 y = 3 }
										
						anti_air = { x = 4 y = 0 }	
						field_gun_brigade = { x = 4 y = 1 }				
					}
					support = {
						artillery = { x = 0 y = 0 }
						artillery_heavy_support = { x = 0 y = 1 }
						recon = { x = 0 y = 2 }
						anti_air_company = { x = 1 y = 0 }
						logistics_company = { x = 1 y = 1 }
						field_hospital = { x = 1 y = 2 }
					}
				}
				division_template = { #MILITIA OF ALL NATION VOLUNTTERS CIVILIANS
					name = "Legión popular" 
					division_names_group = SOV_INF_01
					is_locked = yes
					
					regiments = {
						infantry = { x = 0 y = 0 }
						infantry = { x = 0 y = 1 }
						infantry = { x = 0 y = 2 }

						infantry = { x = 1 y = 0 }
						volkssturm_infantry = { x = 1 y = 1 }
						volkssturm_infantry = { x = 1 y = 2 }
									
						volkssturm_infantry = { x = 2 y = 0 }
						volkssturm_infantry = { x = 2 y = 1 }
						volkssturm_infantry = { x = 2 y = 2 }
										
						artillery_brigade = { x = 3 y = 0 }
						artillery_brigade = { x = 3 y = 1 }	
						artillery_brigade = { x = 3 y = 2 }
						artillery_brigade = { x = 3 y = 3 }
										
						anti_air = { x = 4 y = 0 }	
						field_gun_brigade = { x = 4 y = 1 }				
					}
					support = {
						artillery = { x = 0 y = 0 }
						artillery_heavy_support = { x = 0 y = 1 }
						recon = { x = 0 y = 2 }
						anti_air_company = { x = 1 y = 0 }
						logistics_company = { x = 1 y = 1 }
						field_hospital = { x = 1 y = 2 }
					}
				}
			171 = {	
					create_unit = {
						division = "division_template = \"Legión Popular\" start_experience_factor = 0.6 start_equipment_factor = 1"
						owner = SPN
					}
					create_unit = {
						division = "division_template = \"Legión Popular\" start_experience_factor = 0.6 start_equipment_factor = 1"
						owner = SPN
					}
					create_unit = {
						division = "division_template = \"Legión Popular\" start_experience_factor = 0.6 start_equipment_factor = 1"
						owner = SPN
					}
				}
			}
			custom_effect_tooltip = MANspace
			custom_effect_tooltip = Murcia_soviet_1_units_tooltip
		}
	}

	focus = { 
		id = SPR_soviet_equip_the_carabineros
		icon = GFX_SOV_infantry_development

		relative_position_id = SPR_soviet_small_giver
		x = -3
		y = 1

		cost = 5

		prerequisite = {
			focus = SPR_soviet_small_giver
		}

		ai_will_do = {
			factor = 1
		}

		available = {
			has_global_flag = spanish_civil_war
		}

		bypass = {}

		cancel_if_invalid = yes
		continue_if_invalid = no
		available_if_capitulated = no

		completion_reward = {
			custom_effect_tooltip = SPR_eco_modif
			add_to_variable = {
				var = SPA_rep_industry_industrial_capacity_factory
				value = -0.025
				tooltip = industrial_capacity_factory_tooltip
			}
			custom_effect_tooltip = MANspace
			custom_effect_tooltip = SPA_rep_army_modif
			add_to_variable = {
				SPR_army_morale_factor = -0.05
				tooltip = army_morale_factor_tooltip
			}
			custom_effect_tooltip = MANspace
			add_equipment_to_stockpile = { type = infantry_equipment_0 amount = 1500 producer = SPR }
			add_equipment_to_stockpile = { type = infantry_equipment_0 amount = 5000 producer = SOV } 
		}
	}

	focus = { 
		id = SPR_empty_the_great_war_stockpiles
		icon = GFX_focus_generic_reinforcing_the_supply_network

		relative_position_id = SPR_soviet_equip_the_carabineros
		x = 1
		y = 1

		cost = 5

		prerequisite = {
			focus = SPR_soviet_equip_the_carabineros
		}

		ai_will_do = {
			factor = 1
		}

		available = {
			has_global_flag = spanish_civil_war
		}

		bypass = {}

		cancel_if_invalid = yes
		continue_if_invalid = no
		available_if_capitulated = no

		completion_reward = {
			add_equipment_to_stockpile = { type = field_gun_equipment amount = 300 producer = SOV }
			add_equipment_to_stockpile = { type = pack_artillery_equipment amount = 100 producer = SOV } 
			add_equipment_to_stockpile = { type = anti_air_equipment amount = 300 producer = SOV }
			add_equipment_to_stockpile = { type = anti_tank_equipment amount = 100 producer = SOV } 
		}
	}

	focus = { 
		id = SPR_mountain_artillery
		icon = GFX_focus_ger_bulwark_against_bolshevism

		relative_position_id = SPR_empty_the_great_war_stockpiles
		x = 1
		y = 2

		cost = 5

		prerequisite = {
			focus = SPR_empty_the_great_war_stockpiles
		}

		ai_will_do = {
			factor = 1
		}

		available = {
			has_global_flag = spanish_civil_war
		}

		bypass = {}

		cancel_if_invalid = yes
		continue_if_invalid = no
		available_if_capitulated = no

		completion_reward = {
			add_equipment_to_stockpile = { type = field_gun_equipment amount = 100 producer = SOV }
			add_equipment_to_stockpile = { type = pack_artillery_equipment amount = 500 producer = SOV }
		}
	}

	focus = { 
		id = SPR_local_communist_militia
		icon = GFX_SOV_dual_command

		relative_position_id = SPR_soviet_small_giver
		x = -1
		y = 1

		cost = 5

		prerequisite = {
			focus = SPR_soviet_small_giver
		}

		mutually_exclusive = {
			focus = SPR_soviet_loyalist
		}

		ai_will_do = {
			factor = 1
		}

		available = {
			has_global_flag = spanish_civil_war
		}

		bypass = {}

		cancel_if_invalid = yes
		continue_if_invalid = no
		available_if_capitulated = no

		completion_reward = {
			custom_effect_tooltip = SPA_rep_army_modif
			add_to_variable = {
				SPA_rep_army_attack_factor_var = 0.015
				tooltip = army_attack_factor_tooltip
			}
			add_to_variable = {
				SPA_rep_army_defence_factor_var = -0.03
				tooltip = army_defense_factor_tooltip
			}
				custom_effect_tooltip = MANspace
				hidden_effect = {
					division_template = { #MILITIA OF ALL NATION VOLUNTTERS CIVILIANS
						name = "Legión Popular" 
						division_names_group = SOV_INF_01
						
						regiments = {
							infantry = { x = 0 y = 0 }
							infantry = { x = 0 y = 1 }
							infantry = { x = 0 y = 2 }

							infantry = { x = 1 y = 0 }
							volkssturm_infantry = { x = 1 y = 1 }
							volkssturm_infantry = { x = 1 y = 2 }
										
							volkssturm_infantry = { x = 2 y = 0 }
							volkssturm_infantry = { x = 2 y = 1 }
							volkssturm_infantry = { x = 2 y = 2 }
											
							artillery_brigade = { x = 3 y = 0 }
							artillery_brigade = { x = 3 y = 1 }	
							artillery_brigade = { x = 3 y = 2 }
							artillery_brigade = { x = 3 y = 3 }
											
							anti_air = { x = 4 y = 0 }	
							field_gun_brigade = { x = 4 y = 1 }				
						}
						support = {
							artillery = { x = 0 y = 0 }
							artillery_heavy_support = { x = 0 y = 1 }
							recon = { x = 0 y = 2 }
							anti_air_company = { x = 1 y = 0 }
							logistics_company = { x = 1 y = 1 }
							field_hospital = { x = 1 y = 2 }
						}
					}
					168 = {
						create_unit = {
							division = "division_template = \"Legión Popular\" start_experience_factor = 0.6 start_equipment_factor = 1"
							owner = SPN
						}
						create_unit = {
							division = "division_template = \"Legión Popular\" start_experience_factor = 0.6 start_equipment_factor = 1"
							owner = SPN
						}
						create_unit = {
							division = "division_template = \"Legión Popular\" start_experience_factor = 0.6 start_equipment_factor = 1"
							owner = SPN
						}
						create_unit = {
							division = "division_template = \"Legión Popular\" start_experience_factor = 0.6 start_equipment_factor = 1"
							owner = SPN
						}
					}	
				}
				custom_effect_tooltip = Murcia_interrnational_1_units_tooltip
		}
	}

	focus = { 
		id = SPR_soviet_loyalist
		icon = GFX_SOV_begin_from_nothing

		relative_position_id = SPR_soviet_small_giver
		x = 1
		y = 1

		cost = 5

		prerequisite = {
			focus = SPR_soviet_small_giver
		}

		mutually_exclusive = {
			focus = SPR_local_communist_militia
		}

		ai_will_do = {
			factor = 1
		}

		available = {
			has_global_flag = spanish_civil_war
		}

		bypass = {}

		cancel_if_invalid = yes
		continue_if_invalid = no
		available_if_capitulated = no

		completion_reward = {
				custom_effect_tooltip = SPA_rep_army_modif
			add_to_variable = {
				SPA_rep_army_defence_factor_var = 0.015
				tooltip = army_defense_factor_tooltip
			}
			add_to_variable = {
				SPA_rep_army_attack_factor_var = -0.03
				tooltip = army_attack_factor_tooltip
			}
				custom_effect_tooltip = MANspace
			hidden_effect = {
				168 = {	
					create_unit = {
						division = "division_template = \"Legión Internacional\" start_experience_factor = 0.6 start_equipment_factor = 1"
						owner = SPN
					}
					create_unit = {
						division = "division_template = \"Legión Internacional\" start_experience_factor = 0.6 start_equipment_factor = 1"
						owner = SPN
					}
					create_unit = {
						division = "division_template = \"Legión Internacional\" start_experience_factor = 0.6 start_equipment_factor = 1"
						owner = SPN
					}
				}
			
			}

			custom_effect_tooltip = Murcia_soviet_2_units_tooltip
		}
	}

	focus = { 
		id = SPR_soviet_airwings
		icon = GFX_SOV_red_army_airforce

		relative_position_id = SPR_soviet_small_giver
		x = 0
		y = 2

		cost = 7.15

		prerequisite = {
			focus = SPR_local_communist_militia
			focus = SPR_soviet_loyalist
		}

		ai_will_do = {
			factor = 1
		}

		available = {
			has_global_flag = spanish_civil_war
		}

		bypass = {}

		cancel_if_invalid = yes
		continue_if_invalid = no
		available_if_capitulated = no

		completion_reward = {
			add_equipment_to_stockpile = { type = fighter_equipment_1934 amount = 60 producer = SOV } 
			add_equipment_to_stockpile = { type = tac_bomber_equipment_1934 amount = 60 producer = SOV }   
		}
	}

	focus = { 
		id = SPR_kill_the_traitors_and_fascists
		icon = GFX_focus_generic_attack_nationalist_spain_focus

		relative_position_id = SPR_soviet_airwings
		x = 0
		y = 1

		cost = 7.15

		prerequisite = {
			focus = SPR_soviet_airwings
		}

		ai_will_do = {
			factor = 1
		}

		available = {
			has_global_flag = spanish_civil_war
		}

		bypass = {}

		cancel_if_invalid = yes
		continue_if_invalid = no
		available_if_capitulated = no

		completion_reward = {
			add_timed_idea = {
				idea = SPA_kill_traitors_and_fascists_idea
				days = 90
			}
		}
	}

	focus = { 
		id = SPR_civilian_truck_usage
		icon = GFX_SOV_mass_motorization

		relative_position_id = SPR_soviet_small_giver
		x = 3
		y = 1

		cost = 5

		prerequisite = {
			focus = SPR_soviet_small_giver
		}

		ai_will_do = {
			factor = 1
		}

		available = {
			has_global_flag = spanish_civil_war
		}

		bypass = {}

		cancel_if_invalid = yes
		continue_if_invalid = no
		available_if_capitulated = no

		completion_reward = {
			add_equipment_to_stockpile = { type = motorized_equipment amount = 500 producer = SPR }
		}
	}

	focus = { 
		id = SPA_t80_soviet_tanks
		icon = GFX_SOV_armour_development

		relative_position_id = SPR_civilian_truck_usage
		x = -1
		y = 1

		cost = 5

		prerequisite = {
			focus = SPR_civilian_truck_usage
		}

		ai_will_do = {
			factor = 1
		}

		available = {
			has_global_flag = spanish_civil_war
		}

		bypass = {}

		cancel_if_invalid = yes
		continue_if_invalid = no
		available_if_capitulated = no

		completion_reward = {
			custom_effect_tooltip = SPR_eco_modif
			add_to_variable = {
				var = SPA_rep_industry_industrial_capacity_factory
				value = -0.025
				tooltip = industrial_capacity_factory_tooltip
			}
			custom_effect_tooltip = MANspace
			add_equipment_to_stockpile = { type = light_tank_chassis_1934 amount = 400 producer = SOV }

		create_equipment_variant = {
			name = "T-26 Obr.33"
			type = light_tank_chassis_1934
			parent_version = 0
			modules = {
				main_armament_slot = tank_small_cannon_2
				turret_type_slot = tank_light_two_man_tank_turret
				suspension_type_slot = tank_bogie_suspension
				armor_type_slot = tank_riveted_armor
				armor_sloping_slot = unsloped_armor
				engine_type_slot = tank_gasoline_engine
			}
			upgrades = {
				tank_nsb_engine_upgrade = 2
				tank_nsb_armor_upgrade = 2
			}
			icon = "gfx/interface/technologies/land/sov/sov_light_t26.tga"
		}

		}
	}

	focus = { 
		id = SPA_soviet_tank_division_2
		icon = GFX_SOV_mechanized_wave

		relative_position_id = SPA_t80_soviet_tanks
		x = -1
		y = 2

		cost = 5

		prerequisite = {
			focus = SPA_t80_soviet_tanks
		}

		ai_will_do = {
			factor = 1
		}

		available = {
			has_global_flag = spanish_civil_war
		}

		bypass = {}

		cancel_if_invalid = yes
		continue_if_invalid = no
		available_if_capitulated = no

		completion_reward = {
			hidden_effect = {
				division_template = {
				name = "Brigada Soviética de Tanques"
				division_names_group = SOV_CAV_01 
				is_locked = yes
				force_allow_recruiting = yes
				regiments = {
					light_armor = { x = 0 y = 0 }
					light_armor = { x = 0 y = 1 }
					light_armor = { x = 0 y = 2 }
					
					light_armor = { x = 1 y = 0 }
					light_armor = { x = 1 y = 1 }
					armored_car = { x = 1 y = 2 }		
					
					bicycle_battalion = { x = 2 y = 0 }
					bicycle_battalion = { x = 2 y = 1 }
					motorized = { x = 2 y = 2 }		
					motorized = { x = 2 y = 3 }
					
					cavalry = { x = 3 y = 0 }
					cavalry = { x = 3 y = 1 }		
				
					pack_artillery_brigade_mot = { x = 4 y = 0 }
					pack_artillery_brigade_mot = { x = 4 y = 1 }
					pack_artillery_brigade_mot = { x = 4 y = 2 }
				}
				support = {
					artillery = { x = 0 y = 0 }
					maintenance_company = { x = 1 y = 0 }
					logistics_company = { x = 1 y = 1 }
					field_hospital = { x = 0 y = 1 }
				}
			}
				every_state = {
					limit = { state = 171 }
					create_unit = {
						division = "name = \"1st Brigada Soviética de Tanques.\" division_template = \"Brigada Soviética de Tanques\" start_experience_factor = 0.6 start_equipment_factor = 0.5" 
						owner = SPN
					} 
					create_unit = {
						division = "name = \"2st Brigada Soviética de Tanques.\" division_template = \"Brigada Soviética de Tanques\" start_experience_factor = 0.6 start_equipment_factor = 0.5" 
						owner = SPN
					}
				}
			}
			custom_effect_tooltip = SPA_rep_army_modif
			add_to_variable = {
				SPR_army_org_factor_var = 0.05
				tooltip = army_org_factor_tooltip
			}
			custom_effect_tooltip = MANspace
			custom_effect_tooltip = soviet_army_core_elites
			custom_effect_tooltip = MANspace
			add_equipment_to_stockpile = { type = light_tank_chassis_1934 amount = 80 producer = SOV }
			add_equipment_to_stockpile = { type = armored_cars_equipment amount = 100 producer = SOV }
		
		}
	}

	focus = { 
		id = SPR_mountaineer_aids
		icon = GFX_focus_SOV_builder_of_the_red_army

		relative_position_id = SPR_kill_the_traitors_and_fascists
		x = 0
		y = 2

		cost = 7.15

		prerequisite = {
			focus = SPR_kill_the_traitors_and_fascists
		}

		prerequisite = {
			focus = SPR_mountain_artillery
			focus = SPA_soviet_tank_division_2
		}

			prerequisite = {
			focus = SPA_soviet_tank_division_2
		}

		ai_will_do = {
			factor = 1
		}

		available = {
			has_global_flag = spanish_civil_war
		}

		bypass = {}

		cancel_if_invalid = yes
		continue_if_invalid = no
		available_if_capitulated = no

		completion_reward = {
			custom_effect_tooltip = SPR_eco_modif
			add_to_variable = {
				var = SPA_rep_industry_industrial_capacity_factory
				value = 0.04
				tooltip = industrial_capacity_factory_tooltip
			}
			custom_effect_tooltip = MANspace
			custom_effect_tooltip = SPA_rep_army_modif
			add_to_variable = {
				SPA_rep_rmy_attack_factor_var = 0.05
				tooltip = army_attack_factor_tooltip
			}
			add_to_variable = {
				SPA_rep_army_defence_factor_var = 0.1
				tooltip = army_defense_factor_tooltip
			}
			add_to_variable = {
				SPA_rep_army_org_factor_var = 0.1
				tooltip = army_org_factor_tooltip
			}
			add_to_variable = {
				SPA_rep_army_morale_factor = 0.1
				tooltip = army_morale_factor_tooltip
			}
			add_to_variable = {
				SPA_rep_army_speed_factor_var = -0.03
				tooltip = army_speed_tooltip
			}
			add_to_variable = {
				SPA_rep_max_planning_var = 0.35
				tooltip = max_planning_tooltip
			}
			add_doctrine_cost_reduction = {
				name = land_doc_bonus
				cost_reduction = 0.4
				uses = 1
				category = land_doctrine
			}
		}
	}

	#Every man for Spain

	focus = { 
		id = SPR_republic_army
		icon = GFX_focus_spr_no_pasaran

		relative_position_id = SPR_army_tree_choise
		x = 5
		y = 1

		cost = 5

		prerequisite = {
			focus = SPR_army_tree_choise
		}

		mutually_exclusive = {
			focus = SPR_soviet_small_giver
		}

		ai_will_do = {
			factor = 1
		}

		available = {
			has_global_flag = spanish_civil_war
		}

		bypass = {}

		cancel_if_invalid = yes
		continue_if_invalid = no
		available_if_capitulated = no

		completion_reward = {
			custom_effect_tooltip = SPA_rep_army_modif
			add_to_variable = {
				SPA_rep_army_org_factor_var = -0.05
				tooltip = army_org_factor_tooltip
			}
			add_to_variable = {
				SPR_recruitable_population_factor_var = 0.10
				tooltip = CAN_recruitable_tt1
			}
			add_doctrine_cost_reduction = {
				name = land_doc_bonus
				cost_reduction = 0.4
				uses = 1
				category = land_doctrine
			}
		}
	}

	focus = { 
		id = SPR_secure_last_stockpiles
		icon = GFX_focus_generic_truck

		relative_position_id = SPR_republic_army
		x = -3
		y = 1

		cost = 5

		prerequisite = {
			focus = SPR_republic_army
		}

		ai_will_do = {
			factor = 1
		}

		available = {
			has_global_flag = spanish_civil_war
		}

		bypass = {}

		cancel_if_invalid = yes
		continue_if_invalid = no
		available_if_capitulated = no

		completion_reward = {
			add_equipment_to_stockpile = { type = infantry_equipment_0 amount = 1500 producer = SPR }
			add_equipment_to_stockpile = { type = field_gun_equipment amount = 300 producer = SPR } 
			add_equipment_to_stockpile = { type = anti_air_equipment amount = 140 producer = SPR }
			add_equipment_to_stockpile = { type = anti_tank_equipment amount = 140 producer = SPR } 
		}
	}

	focus = { 
		id = SPR_emergency_munitions_corporations
		icon = GFX_focus_secret_rearmament

		relative_position_id = SPR_secure_last_stockpiles
		x = 1
		y = 1

		cost = 5

		prerequisite = {
			focus = SPR_secure_last_stockpiles
		}

		ai_will_do = {
			factor = 1
		}

		available = {
			has_global_flag = spanish_civil_war
			has_political_power > 49
		}

		bypass = {}

		cancel_if_invalid = yes
		continue_if_invalid = no
		available_if_capitulated = no

		completion_reward = {
			add_political_power = -50
			custom_effect_tooltip = SPR_eco_modif
			add_to_variable = {
				var = SPA_rep_industry_industrial_capacity_factory
				value = 0.03
				tooltip = industrial_capacity_factory_tooltip
			}
			custom_effect_tooltip = MANspace
			add_equipment_to_stockpile = { type = infantry_equipment_0 amount = 4000 producer = SPR }
		}
	}
	focus = { 
		id = SPR_artillery_production
		icon = GFX_focus_jap_zaibatsu

		relative_position_id = SPR_emergency_munitions_corporations
		x = 1
		y = 2

		cost = 7.15

		prerequisite = {
			focus = SPR_emergency_munitions_corporations
		}

		ai_will_do = {
			factor = 1
		}

		available = {
			has_global_flag = spanish_civil_war
		}

		bypass = {}

		cancel_if_invalid = yes
		continue_if_invalid = no
		available_if_capitulated = no

		completion_reward = {
			custom_effect_tooltip = SPR_eco_modif
			add_to_variable = {
				var = SPA_rep_industry_industrial_capacity_factory
				value = 0.03
				tooltip = industrial_capacity_factory_tooltip
			}
			custom_effect_tooltip = MANspace
			add_equipment_to_stockpile = { type = artillery_equipment_1 amount = 300 producer = SPN }
		}
	}

	focus = { 
		id = SPR_rebuild_the_army
		icon = GFX_focus_SOV_mobilization_plan

		relative_position_id = SPR_republic_army
		x = -1
		y = 1

		cost = 5

		prerequisite = {
			focus = SPR_republic_army
		}

		mutually_exclusive = {
			focus = SPR_anarchist_cannon_fodder
		}

		ai_will_do = {
			factor = 1
		}

		available = {
			has_global_flag = spanish_civil_war
		}

		bypass = {}

		cancel_if_invalid = yes
		continue_if_invalid = no
		available_if_capitulated = no

		completion_reward = {
			custom_effect_tooltip = SPA_rep_army_modif

			add_to_variable = {
				SPA_rep_army_org_factor_var = 0.05
				tooltip = army_org_factor_tooltip
			}
			add_to_variable = {
				SPA_rep_recruitable_population_factor_var = -0.05
				tooltip = CAN_recruitable_tt1
			}
		}
	}

	focus = { 
		id = SPR_anarchist_cannon_fodder
		icon = GFX_focus_SOV_penal_battalions

		relative_position_id = SPR_republic_army
		x = 1
		y = 1

		cost = 5

		prerequisite = {
			focus = SPR_republic_army
		}

		mutually_exclusive = {
			focus = SPR_rebuild_the_army
		}

		ai_will_do = {
			factor = 1
		}

		available = {
			has_global_flag = spanish_civil_war
		}

		bypass = {}

		cancel_if_invalid = yes
		continue_if_invalid = no
		available_if_capitulated = no

		completion_reward = {
			custom_effect_tooltip = SPA_rep_army_modif

			add_to_variable = {
				SPA_rep_army_org_factor_var = -0.025
				tooltip = army_org_factor_tooltip
			}
			add_to_variable = {
				SPA_rep_recruitable_population_factor_var = 0.1
				tooltip = CAN_recruitable_tt1
			}
			custom_effect_tooltip = MANspace
			custom_effect_tooltip = SPA_rep_deploy_rep_prisoners
				hidden_effect = {
					division_template = {
						name = "División de Frente Popular Divisions"
						division_names_group = SPR_INF_04
						priority = 0
						is_locked = yes 
						regiments = {
							penal_battalion = { x = 0 y = 0 }
							penal_battalion = { x = 0 y = 1 }
							penal_battalion = { x = 0 y = 2 }

							penal_battalion = { x = 1 y = 0 }
							penal_battalion = { x = 1 y = 1 }
							penal_battalion = { x = 1 y = 2 }

							penal_battalion = { x = 2 y = 0 }
							penal_battalion = { x = 2 y = 1 }
							penal_battalion = { x = 2 y = 2 }

							penal_battalion = { x = 3 y = 0 }
							penal_battalion = { x = 3 y = 1 }
							penal_battalion = { x = 3 y = 2 }
							
							penal_battalion = { x = 4 y = 0 }
							penal_battalion = { x = 4 y = 1 }
							penal_battalion = { x = 4 y = 2 }
										
						}

						support = {
							military_police = { x = 0 y = 0 }
							recon = { x = 1 y = 0 }
						}
					}
					every_owned_state = {
						limit = {
							is_controlled_by = SPN
							state = 167
						}
						create_unit = {
							division = "name = \"División de Frente Popular Divisions\" division_template = \"División de Frente Popular Divisions\" start_experience_factor = 0.0 start_equipment_factor = 0.7" 
							owner = SPN
						}	
						create_unit = {
							division = "name = \"División de Frente Popular Divisions\" division_template = \"División de Frente Popular Divisions\" start_experience_factor = 0.0 start_equipment_factor = 0.7" 
							owner = SPN
						}
						create_unit = {
							division = "name = \"División de Frente Popular Divisions\" division_template = \"División de Frente Popular Divisions\" start_experience_factor = 0.0 start_equipment_factor = 0.7" 
							owner = SPN
						}	
						create_unit = {
							division = "name = \"División de Frente Popular Divisions\" division_template = \"División de Frente Popular Divisions\" start_experience_factor = 0.0 start_equipment_factor = 0.7" 
							owner = SPN
						}	
						create_unit = {
							division = "name = \"División de Frente Popular Divisions\" division_template = \"División de Frente Popular Divisions\" start_experience_factor = 0.0 start_equipment_factor = 0.7" 
							owner = SPN
						}	
						create_unit = {
							division = "name = \"División de Frente Popular Divisions\" division_template = \"División de Frente Popular Divisions\" start_experience_factor = 0.0 start_equipment_factor = 0.7" 
							owner = SPN
						}	
						create_unit = {
							division = "name = \"División de Frente Popular Divisions\" division_template = \"División de Frente Popular Divisions\" start_experience_factor = 0.0 start_equipment_factor = 0.7" 
							owner = SPN
						}	
						create_unit = {
							division = "name = \"División de Frente Popular Divisions\" division_template = \"División de Frente Popular Divisions\" start_experience_factor = 0.0 start_equipment_factor = 0.7" 
							owner = SPN
						}				
					}	
			}

		}
	}

	focus = { 
		id = SPR_internationaL_voluntter_core
		icon = GFX_focus_generic_workers

		relative_position_id = SPR_rebuild_the_army
		x = 1
		y = 1

		cost = 7.15

		prerequisite = {
			focus = SPR_anarchist_cannon_fodder
			focus = SPR_rebuild_the_army
		}

		ai_will_do = {
			factor = 1
		}

		available = {
			has_global_flag = spanish_civil_war
		}

		bypass = {}

		cancel_if_invalid = yes
		continue_if_invalid = no
		available_if_capitulated = no

		completion_reward = {
			army_experience = 75
			add_timed_idea = { idea = SPA_foreign_training_staff days = 730 }
		}
	}

	focus = { 
		id = SPR_night_parties_hunt
		icon = GFX_focus_generic_women_in_military

		relative_position_id = SPR_internationaL_voluntter_core
		x = 0
		y = 1

		cost = 5

		prerequisite = {
			focus = SPR_internationaL_voluntter_core

		}

		ai_will_do = {
			factor = 1
		}

		available = {
			has_global_flag = spanish_civil_war
		}

		bypass = {}

		cancel_if_invalid = yes
		continue_if_invalid = no
		available_if_capitulated = no

		completion_reward = {
			add_equipment_to_stockpile = { type = fighter_equipment_1934 amount = 52 producer = SPR }  
			add_equipment_to_stockpile = { type = fighter_equipment_1934 amount = 20 producer = FRA }  
			add_equipment_to_stockpile = { type = fighter_equipment_1934 amount = 20 producer = SOV } 
			add_ace = {
				name = "Sergey" 
				surname = "Gritsevets"
				callsign = "Sergio"
				type = fighter_genius
			}
			add_ace = {
				name = "Ivan" 
				surname = "Lakeev"
				callsign = "Lucas"
				type = fighter_genius
			}
		}
	}

	focus = { 
		id = SPR_buy_fascist_prisonners_will
		icon = GFX_focus_generic_workers_and_farmers_rise

		relative_position_id = SPR_republic_army
		x = 3
		y = 1

		cost = 5

		prerequisite = {
			focus = SPR_republic_army
		}

		ai_will_do = {
			factor = 1
		}

		available = {
			has_global_flag = spanish_civil_war
			has_political_power > 49
		}

		bypass = {}

		cancel_if_invalid = yes
		continue_if_invalid = no
		available_if_capitulated = no

		completion_reward = {
			add_political_power = -50
			add_manpower = 120000
			SPR = {
				add_manpower = -45000
			}
		}
	}

	focus = { 
		id = SPR_new_calvarary_division
		icon = GFX_focus_generic_horse_studs

		relative_position_id = SPR_buy_fascist_prisonners_will
		x = -1
		y = 1

		cost = 5

		prerequisite = {
			focus = SPR_buy_fascist_prisonners_will
		}

		ai_will_do = {
			factor = 1
		}

		available = {
			has_global_flag = spanish_civil_war
		}

		bypass = {}

		cancel_if_invalid = yes
		continue_if_invalid = no
		available_if_capitulated = no

		completion_reward = {
			
			custom_effect_tooltip = SPA_rep_army_modif
			add_to_variable = {
				SPR_cavalry_attack_factor_var = 0.1
				tooltip = horse_attack_tooltip
			}
			add_equipment_to_stockpile = {
				type = horse_equipment
				amount = 3500
				producer = SPA
			}
			custom_effect_tooltip = MANspace
			custom_effect_tooltip = spanish_horses_spawn_ins_rep
			hidden_effect = {
				division_template = { #PRETTY DERBY
					name = "Caballos Maravilla Popular" 
					division_names_group = SPR_CAV_01
					template_counter = 173
					is_locked = yes
					force_allow_recruiting = yes
					
					regiments = {
						cavalry = { x = 0 y = 0 }
						cavalry = { x = 0 y = 1 }
						cavalry = { x = 0 y = 2 }

						armored_car = { x = 1 y = 0 }
						armored_car = { x = 1 y = 1 }
										
						motorized = { x = 2 y = 0 }
						motorized = { x = 2 y = 1 }
						motorized = { x = 2 y = 2 }
						anti_air_mot = { x = 2 y = 3 }
						
						field_gun_brigade = { x = 3 y = 0 }
						artillery_brigade = { x = 3 y = 1 }
						artillery_brigade = { x = 3 y = 2 }
						pack_artillery_brigade = { x = 3 y = 3 }

						pack_artillery_brigade_mot = { x = 4 y = 0 }	
						pack_artillery_brigade_mot = { x = 4 y = 1 }
		
					}
					support = {
						recon_ac = { x = 0 y = 0 }
						military_police = { x = 0 y = 1 }
						anti_air_company = { x = 1 y = 0 }
						pack_artillery = { x = 1 y = 1 }
					}
				}
			167 = {	
					create_unit = {
						division = "division_template = \"Caballos Maravilla Popular\" start_experience_factor = 0.6 start_equipment_factor = 1"
						owner = SPN
					}
					create_unit = {
						division = "division_template = \"Caballos Maravilla Popular\" start_experience_factor = 0.6 start_equipment_factor = 1"
						owner = SPN
					}
					create_unit = {
						division = "division_template = \"Caballos Maravilla Popular\" start_experience_factor = 0.6 start_equipment_factor = 1"
						owner = SPN
					}
					create_unit = {
						division = "division_template = \"Caballos Maravilla Popular\" start_experience_factor = 0.6 start_equipment_factor = 1"
						owner = SPN
					}
				}
			}
		}
	}

	focus = { 
		id = SPR_mantain_the_stable_front
		icon = GFX_focus_generic_provoke_border_clashes

		relative_position_id = SPR_new_calvarary_division
		x = -1
		y = 2

		cost = 5

		prerequisite = {
			focus = SPR_new_calvarary_division
		}

		ai_will_do = {
			factor = 1
		}

		available = {
			has_global_flag = spanish_civil_war
		}

		bypass = {}

		cancel_if_invalid = yes
		continue_if_invalid = no
		available_if_capitulated = no

		completion_reward = {
			add_equipment_to_stockpile = {
				type = light_tank_chassis_1934
				amount = 200
				producer = SOV
			}
			add_equipment_to_stockpile = {
				type = light_tank_chassis_1936
				amount = 50
				producer = SOV
			}
			add_equipment_to_stockpile = {
				type = motorized_equipment
				amount = 400
				producer = SOV
			}
			add_equipment_to_stockpile = {
				type = motorized_equipment
				amount = 300
				producer = SPA
			}
			add_equipment_to_stockpile = {
				type = armored_cars_equipment
				amount = 120
				producer = SOV
			}
		}
	}

	focus = { 
		id = SPR_the_new_republic_army
		icon = GFX_SOV_breakthrough_priority

		relative_position_id = SPR_mantain_the_stable_front
		x = -1
		y = 1

		cost = 7.15

		prerequisite = {
			focus = SPR_mantain_the_stable_front
		}
		prerequisite = {
			focus = SPR_night_parties_hunt
		}
		prerequisite = {
			focus = SPR_artillery_production
			focus = SPR_mantain_the_stable_front
		}

		ai_will_do = {
			factor = 1
		}

		available = {
			has_global_flag = spanish_civil_war
		}

		bypass = {}

		cancel_if_invalid = yes
		continue_if_invalid = no
		available_if_capitulated = no

		completion_reward = {
			custom_effect_tooltip = SPA_rep_army_modif

			add_to_variable = {
				SPA_rep_army_speed_factor_var = 0.05
				tooltip = max_planning_tooltip
			}
			add_to_variable = {
				SPA_rep_army_attack_factor_var = 0.05
				tooltip = army_attack_factor_tooltip
			}
			add_to_variable = {
				SPA_rep_army_defence_factor_var = 0.05
				tooltip = army_defense_factor_tooltip
			}
			add_doctrine_cost_reduction = {
				name = land_doc_bonus
				cost_reduction = 0.4
				uses = 1
				category = land_doctrine
			}
		}
	}



}

	